---
title: TCP-Protocol
tags: 计算机网络
abbrlink: 953c3a3d
date: 2020-06-25 14:45:19
---
## TCP报文组成
TCP报文段分为首部和数据两部分，整个TCP报文段作为IP数据报的数据部分被封装在IP数据报中，TCP的首部前20B是固定的，后面有4N字节是根据需要而增加的选项，通常长度为4B的整数倍。
1. 源端口和目的端口 各占2B 运输层的服用和分用功能都需要通过端口实现。
2. 序号字段 占4B TCP是面向字节流的，所以TCP连接传送的数据流中的每个字节都编上一个序号，序号字段的值指的是本报文段所发送的数据的第一个字节的序号。
3. 确认号字段。 占4B ，期望收到对方的下一个报文段的数据的第一个字节的序号。若确认号为N，则标明序号N-1为止的所有数据都已经被收到。
4. 数据偏移（即首部长度）。占4位，单位为4B，它指出TCP报文段的数据起始位置距离TCP报文段的起始处有多远。
5. 保留字段， 占6bits， 待以后使用
6. 紧急位URG 当URG=1时 ，表明紧急指针字段有效，需要和紧急指针配合使用。
7. ACK确认位  只有当ACK=1时 确认号字段才有效，当ACK=0时，确认号字段无效。
8. 推送位PSH（PUSH） 接受TCP收到PSH=1的报文段，就尽快的交付给接受应用进程，而不在等到整个缓存都填满后再向上交付。
9. 复位位 RST（Reset） RST=1 时 表明TCP连接中出现严重差错，必须是放链接，然后再重新建立运输连接。
10. 同步位SYN 同步SYN=1 表示这个是 连接请求报文或连接接收报文。eg： SYN=1，ACK=0 这是一个连接请求报文，SYN=1，ack=1，表明对方同意建立连接。
11. FIN终止位 (Finish ) 用来释放连接。
12. 窗口字段 占2B， 指现在允许对方发送的数据量
13. 校验和 占2B， 校验首部和数据部分
14. 紧急指针字段 占16bits 指出本报文段紧急数据有多少字节。
15. 选项字段 长度可变， TCP最开始只规定了一种选项 即最大报文长度（MAximum Segment Size MSS） MSS指的是数据部分的最大值。
16. 填充字段  保持4B的整数倍。
