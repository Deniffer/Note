---
title: MAC (Medium Access Control)
tags: 计算机网络
abbrlink: e879df5d
date: 2020-06-14 15:45:03
---

[详解](https://blog.csdn.net/N1neDing/article/details/80718885)
[最小帧长理解](https://www.cnblogs.com/aixin0813/p/3310040.html)
[百度百科](https://baike.baidu.com/item/CSMA/CA/10898090?noadapt=1)
MAC层主要任务是对使用介质的每个节点隔离来自同一信道其他节点所传你送的信号，以协调活动节点的传输。 常见的介质访问方法有信道划分介质访问控制，随机访问介质访问控制和轮询访问介质访问控制。其中前者是静态划分信道，后两者是动态划分信道。
 <!-- more -->
### 信道划分介质访问控制
这里主要应用了多路复用和多路分解的技术。
1. 频分多路复用（FDM）
将多路基带信号调制到不同频率载波上，再叠加成一个复合信号的多路复用技术。每个子信道分配的带宽可以不相同，但总和要小于总带宽，实际应用中为了防止子信道之间的干扰，相邻信道之间需要加入“保护频带”

2. 时分多路复用（TDM）
将一条物理信道按时间分成若干时间片，轮流分给多个信号使用。统计十分多路复用（STMD 又称异步时分多路复用）是TDM的一种改进，采用STDM帧，按需动态分配时隙。

3. 波分多路复用（WDM）
波分多路复用即光的频分多路复用，他在一根光纤中传输不同波长（频率）的光信号，由于波长不同，互不干扰，最后再用波长分解复用器将各路波长分解出来。

4. 码分多路复用（CDM）
采用不同编码来区别各路原始信号的一种复用方式，既共享信道的频率，又共享信道的时间。码分多址（Code Division Multiple Access ，CDMA）是码分复用的一种方式，其原理是将每比特时间被分成m个更短的时间槽，称为码片（chip）通常情况下每比特 有64或者128个码片。每个站点被指定一个唯一的m位码片序列。发送1时，站点发送码片序列；发送0时，站点发送码片序列的反码。当两个或者多个站点同时发送时，各路数据在信道中线性相加。

### 随机访问介质访问控制
常用协议有ALOHA协议，CSMA协议，CSMA/CD协议，CSMA/CA协议。核心思想想都是：胜利者通过争用获得信道，从而获得信息的发送权，随机访问介质访问控制协议又称争用型协议

##### ALOHA协议和时隙 ALOHA
纯ALOHA：数据随便发，如果没有收到回复就认为发生冲突等待随机时间再发。<br>
时隙ALOHA：把各个站点的时间同步，并将时间划分为等长的时隙（slot）规定每个时隙开始时才能发送一个帧。

##### CSMA协议（Carrier Sense Multiple Access protocol）
信道三种存在状态：空闲，忙，数据发生冲突
CSMA类协议都是先侦听信道，发现信道空闲时才发送帧，这样就可以大大降低发生冲突的机会。
根据侦听方式和侦听到信道忙后的处理方式不同，CSMA协议分成三种。(这三种协议都是冲突停发，随机重发)
(1). 1-坚持CSMA ：一个结点要发送数据时，先侦听信道是否空闲，如果空闲则立刻发送数据，如果忙的话就等待，如果发生冲突则等待随机时间后再次侦听信道。
1-坚持CSMA的含义就是一直侦听信道，一旦不忙就立刻发生数据。<br>
(2).非坚持-CSMA（Non-persistent CSMA） 一个结点要发送数据时，节点首先监信道；如果空闲则立刻发送数据，如果忙就放弃侦听，等待随机时间后再次侦听。<br>
(3).p-坚持CSMA :一个节点发送数据时，先侦听信道是否空闲，如果忙的话则持续监听，直至信道空闲，如果信道空闲，就以p的概率发送数据。<br>

##### CSMA/CD (Carrier Sense Multiple Access with Collision Detection)载波侦听多路访问/碰撞检测

CSMA/CD 被广泛应用于有线连接的局域网。CSMA/CD的特点就是“先听后发，边听遍发，冲突停发，随机重发”
工作流程：
1. 适配器从其父节点获得一个网络层数据包，准备一个以太网帧，并把该帧放到适配器缓冲区中。
2. 如果适配器侦听到信道空闲，那么他开始传输该帧，如果信道忙，那将等待直至侦听到空闲。
3. 在传输过程中，适配器检测来自其他适配器的信号能量。如果该适配器已经传输了整个帧而没有来自其他适配器的信号能量，则适配器完成这个帧的传输，否则适配器停止传输该帧，转而发送一个48bits的拥塞信号，加强拥塞信号
4. 在终止（即传输拥塞信号后），适配器采用截断二进制指数退避算法等待随机一段时间返回至步骤2. 
为了确保发送站再发送数据的同时能检测到可能存在的冲突，需要在发送完帧之前就能收到自己发送出去的数据（探测帧），即帧的传输时延要至少大于两倍于信号在总线中的传播时延。<br>
Formula:
$$\frac{最小帧长}{数据传输率} = 总线传播时延  * 2$$

##### 二进制指数退避算法	
第一次冲突 从0-1个时间片里选择一个进行延迟。
第二次冲突 从0-3个时间片里选择一个进行延迟。
第i次冲突 从0-2^j-1个随便选择一个，i<16,j=min(i,10) 
> tips j只会增长到10 就不再增长了，但是冲突次数还是可以增加到16次。


##### CSMA/CA (Carrier Sense Multiple Access/Collision Avoidance)碰撞避免
广泛应用于无线局域网，理由如下：
(1). 无线局域网中，接收信号的强度远大于发送信号的强度，且无线介质上强度的动态变化范围很大，特别是碰撞检测部分，则硬件上的花费就会过大
(2). 在无线通信中，并不是所有的站点都能发现对方，存在隐蔽站的问题。
